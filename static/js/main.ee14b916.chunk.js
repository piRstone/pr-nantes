(this["webpackJsonppr-nantes"]=this["webpackJsonppr-nantes"]||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(25)},,,,,function(e,t,a){},function(e,t,a){},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(4),o=a.n(c),i=a(3),s=a.n(i),l=(a(15),a(2)),u=(a(16),a(8)),p=a(9);a(22);var m=function(e){var t=e.data,a=e.refresh,c=e.isLoading,o=Object(n.useState)(void 0),i=Object(l.a)(o,2),s=i[0],m=i[1];return Object(n.useEffect)((function(){if(t.length){var e=t[0].record_timestamp,a=new Date(e),n=a.getHours(),r=a.getMinutes();r=r<10?"0".concat(r):r,m("".concat(n,"h").concat(r))}}),[t]),r.a.createElement("div",{className:"header-wrapper"},r.a.createElement("header",null,r.a.createElement("h1",{className:"header-title"},"P+R Nantes"),r.a.createElement("p",{className:"header-version"},"v1.0.0")),s&&r.a.createElement("div",{className:"header-timestamp-wrapper"},r.a.createElement("p",null,"Mis \xe0 jour aujourd'hui \xe0 ",s),r.a.createElement("button",{type:"button",onClick:a,className:"header-refresh-button"},r.a.createElement(u.a,{icon:p.a,color:"#616161",spin:c}))))};a(23);var d=function(e){var t=e.data,a=e.onClick,n=t.fields.grp_disponible,c="marker ".concat(0===n?"danger":n<10?"warning":"");return r.a.createElement("div",{onClick:function(){return a(t)},className:c},n)};a(24);var f=function(e){var t=e.data,a=e.visible,n=e.onClick;if(!t)return r.a.createElement("div",{className:"popup-wrapper"});var c,o=t.fields,i=o.grp_nom,s=o.grp_disponible,l=o.grp_exploitation,u="popup-wrapper ".concat(a?"visible":""),p="popup-count ".concat(0===s?"danger":s<10?"warning":"");return c=0===s?"Aucune place disponible":1===s?"1 place disponible":"".concat(s," places disponibles"),r.a.createElement("div",{className:u,onClick:n},r.a.createElement("div",{className:p},s),r.a.createElement("div",{className:"popup-informations"},r.a.createElement("h3",{className:"popup-park-name"},i),r.a.createElement("p",{className:""},c),r.a.createElement("p",null,"Nombre de places totales : ",r.a.createElement("strong",null,l))))};var v=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)([]),u=Object(l.a)(i,2),p=u[0],v=u[1],b=Object(n.useState)(!1),h=Object(l.a)(b,2),E=h[0],g=h[1],j=Object(n.useState)(void 0),w=Object(l.a)(j,2),k=w[0],N=w[1],O=Object(n.useState)(!1),C=Object(l.a)(O,2),M=C[0],y=C[1],_=Object(n.useRef)();Object(n.useEffect)((function(){a||function(e){var t=e.setMap,a=e.mapContainer,n=new s.a.Map({container:a.current,style:"mapbox://styles/mapbox/streets-v11",center:[-1.5543,47.2107],zoom:10});n.on("load",(function(){t(n),n.resize()}))}({setMap:c,mapContainer:_}),J()}),[]);var S=Object(n.useCallback)((function(e){if(k&&k.fields.idobj===e.fields.idobj)return y(!1),void setTimeout((function(){N(void 0)}),300);N(e),y(!0)}),[k]);Object(n.useEffect)((function(){a&&p.length&&p.forEach((function(e){if(e.geometry){var t=e.fields.grp_disponible,n=document.createElement("div");n.className="marker ".concat(0===t?"danger":t<10?"warning":""),n.innerText=t;var c=document.createElement("div");o.a.render(r.a.createElement(d,{data:e,onClick:S}),c),new s.a.Marker({element:c}).setLngLat(e.geometry.coordinates).addTo(a)}}))}),[a,p,S]);var J=function(){g(!0),fetch("https://data.nantesmetropole.fr/api/records/1.0/search/?dataset=244400404_parcs-relais-nantes-metropole-disponibilites&q=&rows=30&facet=grp_nom&facet=grp_statut").then((function(e){return e.json()})).then((function(e){g(!1),v(e.records)}),(function(e){g(!1),console.log("Error: ",e)}))};return r.a.createElement("div",{className:"App"},r.a.createElement("div",{ref:_,className:"mapContainer"}),r.a.createElement(m,{data:p,refresh:J,isLoading:E}),r.a.createElement(f,{data:k,visible:M,onClick:function(){return y(!1)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.accessToken="pk.eyJ1IjoicGlyc3RvbmUiLCJhIjoiY2tmNDMzNTd4MDk1YTJxczdleXdqM2lrZiJ9.Og2gHJR4QWSTe20-7pq9Iw",o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.ee14b916.chunk.js.map